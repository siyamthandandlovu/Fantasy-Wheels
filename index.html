<!DOCTYPE html>
<!--Siyamthanda Ndlovu u21582735-->
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="css/styling.css">
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.4.2.min.js"></script>
    </head>
    <body>

        <div class="divLogoHead" >
            <img src="images/HorizontalLogo.png" class = "imgHeadLogo"/>
        </div>

        <div class="divDivide" >

        </div>

        <div class="searchBar" >
            <h3 >Search</h3>
            <input type="search" name="inputSearchBar" id="inputSearchBar" style="width: 500px"> 
            <button class="buttonSearchBar" value="Search">Search</button>
        </div>

 
        <div class="navBarTagDiv"> 
            <nav class="navTag">
                <a href="https://wheatley.cs.up.ac.za/u21582735/COS216/index.html">Launch Page</a> | <a href="index.html">Cars Page</a> |<a href="Brands.html">Brands</a> | <a href="FindCar.html">Find a Car</a> | <a href="Compare.html">Compare Cars</a>
            </nav>
        </div>

        <div class="divFilterCars">
            <h3 >Filter Cars</h3>
            <form class ="formFilterCars">
                <input type="checkbox" class="checkboxFilterCars" id = "chkboxShowAll">Show All |
                <input type="checkbox" class="checkboxFilterCars"> Auto Gearshift 
                <input type="checkbox" class="checkboxFilterCars"> Manual Gearshift | 
                <input type="checkbox" class="checkboxFilterCars"> Chevrolet
                <input type="checkbox" class="checkboxFilterCars"> Mercedes-Benz 
                <input type="checkbox" class="checkboxFilterCars"> BMW 
                <input type="checkbox" class="checkboxFilterCars"> Delos 
                <input type="checkbox" class="checkboxFilterCars"> Mutt Cutts 
                <input type="checkbox" class="checkboxFilterCars"> Bruce Wayne Enterprises 
                <input type="checkbox" class="checkboxFilterCars"> Mystery Machine 
                <input type="submit" value="Apply Filters">
            </form>
        </div>

        <div class="divSortCars">
            <h3 >Sort Cars</h3>
            <form class="formSortCars">
                <input type="radio" class="radioSortCars"> None |
                <input type="radio" class="radioSortCars"> Year | 
                <input type="radio" class="radioSortCars"> Cost | 
 
                <input type="submit" value="Sort Cars">
            </form>
        </div>
        <br>

        <div class="divDivide" >
        </div>


        <h1 class="pageTitles" >Car Gallery</h1>

<!-- VERY IMPORTANT
 -->

<div id="DisplayAllCars">

</div>



<!-- VERY IMPORTANT
 -->

    <!--<div>
        <table class="NavBarTable">
            <tr>
                <td class="NavBarElement"> <a href="Brands.html">Brands</a> </td> 
                <td class="NavBarElement"> <a href="FindCar.html">Find a Car</a> </td> 
                <td class="NavBarElement"> <a href="Compare.html">Compare Cars</a> </td> 
            </tr>
        </table>
    </div>-->


<!--
       <div class="carDiv"> 
            <img class ="imgCars" src="images/The Bumble Bee car.jpg" />
            <table class="carDesc" >
                <tr>
                    <td>Car Brand</td> <td>Chevrolet</td>
                </tr>
                <tr>
                    <td>Model</td> <td>The Bumble</td>
                </tr>
                <tr>
                    <td>Year</td> <td>2013</td>
                </tr>
                <tr>
                    <td>Number of Seats</td> <td>4</td>
                </tr>
  
                <tr>
                    <td>Gearshift</td> <td>Auto</td>
                </tr>
                <tr>
                    <td>Status</td> <td>In Production</td>
                </tr>  
                <tr>
                    <td>Best Use</td> <td>Daily Transport</td>
                </tr> 
                <tr>
                    <td>Cost</td> <td>R1 697 600</td>
                </tr>
            </table>
        </div>


-->


<!--//////////////////////////////////////////////////////////////////////////-->
<script language="javascript">
var arrayOfCarImageIDs = [];

/* This is what we do when the page opens at the very beginning */





////////////////////////////////////////////////////////////////////////////////////
function LoadMatchingPictures() {
    console.info('ENTERING LOOP ITERATION ');
for (var i = 0; arrayOfCarImageIDs.length; i++) {

console.info('ENTERING LOOP ITERATION ', i);
var xht = new XMLHttpRequest();
//https://wheatley.cs.up.ac.za/api/getimage?brand=audi&model=R8
var openGETURL = 'https://wheatley.cs.up.ac.za/api/getimage?';
// + 'brand = '
    xht.open('GET' , 'https://wheatley.cs.up.ac.za/api/getimage?'+arrayOfCarImageIDs[i] , true);//because everything above has to load first? idk CHECK^^^^
    //xht.setRequestHeader("Content-Type", "application/json;");
   console.log(xht);
    xht.onreadystatechange = function() {
        if (xht.readyState == 2) {
            //idk display something
            console.log('the ready state is 2');
        }
        else if (xht.readyState==4 && xht.status==200) { //everything is ready
            var VariablearrayOfCarImageIDs = arrayOfCarImageIDs[i];
            var DivTarget = document.getElementById(VariablearrayOfCarImageIDs);
            if (DivTarget == null) {
                console.error('the Car Image Array we want to display in is empty was not found; Exiting the funciton');//can you like? just return;
            return;
            }

            console.log('Response Text Type' , xht.responseType , xht.responseText);
            //var API_VALUES = encodeURI(xht.responseText);//but if its json, dont we just parse json?
            var FinalInnerHTML = '';


            //jQuery("#arrayOfCarImageIDs[i]").attr('src = API_VALUES',);
           // $(VariablearrayOfCarImageIDs).attr("src", "https://www.w3docs.com/uploads/media/default/0001/05/9eb9e9cba721ba3bb5e653751449173197f2924a.png");
            $(VariablearrayOfCarImageIDs).attr("src", xht.responseText);

            /* FinalInnerHTML = ' <div class="API_Details"> <img class ="imgCars" src= "' 
            + API_VALUES + '" alt="API Car Image"></div> <br>'; */

           // console.log(i,' IS =');//note i belongs to for loop

            console.log(FinalInnerHTML);
            DivTarget.innerHTML += FinalInnerHTML;//moving this in instead of having it outside fixed the issue of the error being
           // }
 
            
        }
    }
    
 console.log('Response Should Be Images' , xht.responseText);

//var sendingParam = ' {"brand":"audi"} ';
xht.send(); 
}//end of looping for sending the images specifically
}
//////////////////////////////////////////////////////////////////////////////////////////////////



























//window.onload = function() {//as in load all the pics when the do loads

var xhrPostCarText = new XMLHttpRequest();

/* THIS IS POST FOR THE  */
xhrPostCarText.open('POST' , 'https://wheatley.cs.up.ac.za/api/' , true);
xhrPostCarText.setRequestHeader("Content-Type", "application/json");
   console.log(xhrPostCarText);

   xhrPostCarText.onreadystatechange = function() {
        if (xhrPostCarText.readyState == 2) {
            //idk display something
            console.log('the ready state is 2');
        }
        else if (xhrPostCarText.readyState==4 && xhrPostCarText.status==200) { //everything is ready
            var DivTarget = document.getElementById('DisplayAllCars');


            var API_VALUES = JSON.parse(xhrPostCarText.responseText);//json parse so we can see that its of value
           // var API_VALUES = xhrPostCarText.responseText.data;//json parse so we can see that its of value
            //var API_VALUES = JSON.parse(xhrPostCarText.responseText.data);
            console.log('Response Text data' , xhrPostCarText.responseType , xhrPostCarText.responseText);
            console.log( JSON.parse(xhrPostCarText.responseText));
            console.log(API_VALUES); 

            console.log(API_VALUES);
            //var API_VALUES = encodeURI(xhrPostCarText.responseText);//but if its json, dont we just parse json?

            //console.log('This is the response text from this request' , API_VALUES);
            var FinalInnerHTML = '';
            console.log('The Loggin #4:' , API_VALUES)
            /* for (var i in API_VALUES) */   

            for(var i=0; i < 20; i++ )  {
                console.log(API_VALUES.data[i]);
            FinalInnerHTML = ' <div class="carDiv" id="API_Details_CarDescDiv_'+i+'">  '
            
            +' <br> <table class="carDesc" > <tr> <td>Car Brand</td> <td>'+ API_VALUES.data[i].make+'</td></tr> '
            +' <tr> <td>Model </td> <td>'+ API_VALUES.data[i].model +'</td></tr> '
            +' <tr> <td>Year </td> <td>'+ API_VALUES.data[i].year_to +'</td></tr>'
            +' <tr> <td>Generation </td> <td>'+ API_VALUES.data[i].generation +'</td></tr>'
            +' <tr> <td>Series </td> <td>'+ API_VALUES.data[i].series +'</td></tr>'
            +' <tr> <td>Number of Seats </td> <td>'+ API_VALUES.data[i].number_of_seats +'</td></tr>'
            +' <tr> <td>Transmission </td> <td>'+ API_VALUES.data[i].transmission +'</td></tr>'
            +' <tr> <td>Max Speed </td> <td>'+ API_VALUES.data[i].max_speed_km_per_h +'</td></tr>'
           // +'<img class ="imgCars" id="API_CarImage' +i+ '">'
           +'<img class ="imgCars" id="brand='+ API_VALUES.data[i].make +'&model=' + API_VALUES.data[i].model + '">'
            +'</div> <br>';

            arrayOfCarImageIDs[i] = 'brand='+ API_VALUES.data[i].make +'&model=' + API_VALUES.data[i].model ;
            console.log('The ID of this Image:' , arrayOfCarImageIDs[i]);

////https://wheatley.cs.up.ac.za/api/getimage?brand=audi&model=R8

            console.log(i,' IS =');//note i belongs to for loop

            console.log(FinalInnerHTML);
            DivTarget.innerHTML += FinalInnerHTML;//moving this in instead of having it outside fixed the issue of the error being
            
        
 
///////////////////////////////////////////////////////////////////////////////////

var xht = new XMLHttpRequest();
//https://wheatley.cs.up.ac.za/api/getimage?brand=audi&model=R8
var openGETURL = 'https://wheatley.cs.up.ac.za/api/getimage?';
// + 'brand = '
    xht.open('GET' , 'https://wheatley.cs.up.ac.za/api/getimage?' + arrayOfCarImageIDs[i] , false);//because everything above has to load first? idk CHECK^^^^
   console.log(xht);
    xht.onreadystatechange = function() {
        
        if (xht.readyState == 2) {
            //idk display something
            console.log('the ready state is 2 and its not ready i guess?');
        }
        else if (xht.readyState==4 && xht.status==200 && xhrPostCarText.status==200 && xhrPostCarText.readyState==4) { //everything is ready
            var imageIdTemp = arrayOfCarImageIDs[i];
            var DivTarget = document.getElementById(imageIdTemp);

            if (DivTarget == null) {
                console.error('the Car Image Array we want to display in is empty was not found; Exiting the funciton');//can you like? just return;
            return;
            }

            console.log('Response Text Type for CAR IMAGE' , xht.responseType , xht.responseText);
            //var API_VALUES = encodeURI(xht.responseText);//but if its json, dont we just parse json?
            var FinalInnerHTML = '';


            //jQuery("#arrayOfCarImageIDs[i]").attr('src = API_VALUES',);
            //$("#arrayOfCarImageIDs[i]").attr("src", "https://www.w3docs.com/uploads/media/default/0001/05/9eb9e9cba721ba3bb5e653751449173197f2924a.png");
            $(imageIdTemp).attr("src", "https://wheatley.cs.up.ac.za/api/images/models/ac_cobra.jpg");

            /* FinalInnerHTML = ' <div class="API_Details"> <img class ="imgCars" src= "' 
        
                + API_VALUES + '" alt="API Car Image"> </div> <br>'; */
           // console.log(i,' IS =');//note i belongs to for loop

            console.log(FinalInnerHTML);
            DivTarget.innerHTML += FinalInnerHTML;//moving this in instead of having it outside fixed the issue of the error being
           // }
 
            
        }
    }
    
 console.log('Response Should Be Images' , xht.responseText);

//var sendingParam = ' {"brand":"audi"} ';
xht.send(); 
///////////////////////////////////////////////////////////////////////////////////

       
        
        
        
        
        
        
        }
            
            /*jQuery("#imageID").attr('src',);*/
            
            //console.log(FinalInnerHTML);
            //DivTarget.innerHTML += FinalInnerHTML;
            
        }
    }
 console.log('Response Text Text' , xhrPostCarText.responseText);
//var sendingParamArrayToReturn = "[ 'make', 'model', 'generation',  'series', 'number_of_seats', 'height_mm', 'number_of_cylinders', 'engine_type', 'transmission', 'max_speed_km_per_h";
var sendingParam = ' {"studentnum":"u21582735" , "apikey":"a9198b68355f78830054c31a39916b7f" , "type":"GetAllCars" , "return": "*", "limit":20 } ';

xhrPostCarText.send(sendingParam); 


 //LoadMatchingPictures();



















































/*so i should get the cars first, creating ids per table element ModelElement and brand elemement neh
then for each car, loop and sub the brand name and model into the open url and this should be for the loop
returning all the fo i in getelements by class or something*/





//}//document.onload





</script>
<!--//////////////////////////////////////////////////////////////////////////////-->

</body>

</html>